
/*创建视图*/
CREATE OR REPLACE VIEW view_zhxx AS SELECT  bh As 用户编号 , (CASE zhxx.zhlx WHEN 0 THEN '计费' WHEN 1 THEN '计时' WHEN 2 THEN '限时段' WHEN 3 THEN '免费' WHEN 4 THEN '漫游' END)  AS 帐号类型, (CASE hy WHEN 0 THEN '普通临时' WHEN 1 THEN '手动开机'  WHEN 2 THEN '会员' END) AS 用户类型, (CASE fffs WHEN 0 THEN '预付费'  WHEN 1 THEN '后付费' END) As 付费方式, hydj.djmc As 会员等级, xm AS 姓名, zh AS 帐号, zjdm.zjlx As 证件名称, zjh AS 证件号, (case zhxx.ljjf when 0 then '不立即' when 1 then '立即' end) as '立即计费', ljyfe AS '累计预付额(手动开机押金)', ye AS 余额, syjs AS 剩余机时, zse AS 赠送额, ljzse AS '累计赠送额(手动开机赠送)', khe AS 开户额, khsj AS 开户时间, (CASE yxx WHEN 0 THEN '无效'  WHEN 1 THEN '有效' END) As 有效性, (CASE zxzt WHEN 0 THEN '离线'  WHEN 1 THEN '在线' END) As 在线状态, zhdlsj AS 最后登录时间, qysj AS 启用时间, zhxx.czydh AS 操作员代号, bz AS 备注, hyjf AS 会员积分, ljjs AS 累积机时, sjje AS 实际金额, cast(if(time(yxdlsjd.kssj) = time(yxdlsjd.jssj),concat(time(yxdlsjd.kssj), '-次日', time(yxdlsjd.jssj)),concat(time(yxdlsjd.kssj), '-', time(yxdlsjd.jssj)))  as char) as '允许上机时间段', yxq AS 有效期, MAKE_SET(xq, '星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期日') as 星期, sfdbh AS 收费端编号 From zhxx inner join zjdm on (zhxx.zjdm=zjdm.dh) inner join hydj on (zhxx.hydj=hydj.jbh) inner join yxdlsjd on (yxdlsjd.dh = zhxx.sddm) order by zh

